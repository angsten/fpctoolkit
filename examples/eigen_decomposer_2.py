from fpctoolkit.structure.perovskite import Perovskite
from fpctoolkit.io.vasp.outcar import Outcar
from fpctoolkit.phonon.eigen_structure import EigenStructure
from fpctoolkit.structure_prediction.taylor_expansion.variable import Variable
from fpctoolkit.structure_prediction.taylor_expansion.expansion_term import ExpansionTerm
from fpctoolkit.structure_prediction.taylor_expansion.taylor_expansion import TaylorExpansion
from fpctoolkit.structure_prediction.taylor_expansion.derivative_evaluator import DerivativeEvaluator
from fpctoolkit.workflow.vasp_relaxation import VaspRelaxation
from fpctoolkit.util.path import Path
from fpctoolkit.phonon.hessian import Hessian
from fpctoolkit.structure.structure import Structure
from fpctoolkit.workflow.vasp_run import VaspRun
from fpctoolkit.io.vasp.incar_maker import IncarMaker
from fpctoolkit.io.vasp.kpoints import Kpoints
from fpctoolkit.io.vasp.vasp_input_set import VaspInputSet
from fpctoolkit.structure_prediction.taylor_expansion.minima_relaxer import MinimaRelaxer
from fpctoolkit.io.file import File
from fpctoolkit.workflow.epitaxial_relaxer import EpitaxialRelaxer
from fpctoolkit.structure.displacement_vector import DisplacementVector
from fpctoolkit.structure.lattice import Lattice

import sys
import numpy as np



fex = [
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.12796, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 0.24619, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000,
	 -0.09810, 0.00000, 0.00000,
	 -0.13855, 0.00000, 0.00000
	 ]


fey = [
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.12796, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  0.24619, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.13855, 0.00000,
	0.00000,  -0.09810, 0.00000,
	0.00000,  -0.13855, 0.00000
	]

fez = [
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.12796,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  0.24619,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.13855,
	0.00000,  0.00000,  -0.09810,
	0.00000,  0.00000,  -0.13855
	]

aminus = [
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000, -0.25000,
	  0.00000,  0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.25000,
	  0.00000, -0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.25000,
	  0.00000, -0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000, -0.25000,
	  0.00000,  0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.25000,
	  0.00000, -0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000, -0.25000,
	  0.00000,  0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000, -0.25000,
	  0.00000,  0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000,
	  0.00000,  0.00000,  0.25000,
	  0.00000, -0.25000,  0.00000,
	  0.00000,  0.00000,  0.00000
	  ]

bminus = [
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 -0.25000, 0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000,  0.00000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.00000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.00000,  0.00000,
	 -0.25000, 0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000,  0.00000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.00000,  0.00000,
	 -0.25000, 0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000,  0.00000,  0.00000,
	 -0.25000, 0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000,  0.00000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000
	 ]

cminus = [
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000, -0.25000,  0.00000,
	-0.2500,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.25000,  0.00000,
	-0.2500,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.25000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000, -0.25000,  0.00000,
	-0.2500,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.25000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000, -0.25000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000, -0.25000,  0.00000,
	-0.2500,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.25000,  0.00000
	]

cplus = [
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 -0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.25000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000, -0.25000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000, -0.25000,  0.00000,
	 -0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.25000,  0.00000,
	 -0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.25000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000, -0.25000,  0.00000,
	 0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000, -0.25000,  0.00000,
	 -0.25000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.25000,  0.00000
	 ]

aplus = [
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000, -0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000, -0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000, -0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000,  0.25000,
	 0.00000, -0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000,
	 0.00000,  0.00000, -0.25000,
	 0.00000,  0.25000,  0.00000,
	 0.00000,  0.00000,  0.00000
	 ]

bplus = [
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.25000,
	0.00000,  0.00000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000, -0.25000,
	0.00000,  0.00000, -0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.25000,
	0.00000,  0.00000, -0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000, -0.25000,
	0.00000,  0.00000, -0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000, -0.25000,
	0.00000,  0.00000, -0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.25000,
	0.00000,  0.00000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000, -0.25000,
	0.00000,  0.00000,  0.00000,
	0.25000,  0.00000,  0.00000,
	0.00000,  0.00000,  0.25000
	]


print                                                                               np.dot(fex, bplus)
# sys.exit()




if __name__ == '__main__':

	reference_structure_path = '../data/reference_structure.vasp'


	reference_structure = Structure(reference_structure_path)


	displacement_vector = np.array(fey)

	displacement_vector *= 1.0

	distorted_structure = DisplacementVector.displace_structure(reference_structure=reference_structure, displacement_vector=displacement_vector, displacement_coordinate_mode='Cartesian')

	distorted_structure.to_poscar_file_path('../data/fey.vasp')


	#relaxed_structure = Structure('./n0p035_rel_struct_0_ver_fixed')
	#eigen_amplitude_analysis_hessian = Hessian(outcar=Outcar("./dfpt_outcar"))
	#eigen_amplitude_analysis_reference_structure = Structure("./reference_structure")
	#eigen_structure = EigenStructure(reference_structure=eigen_amplitude_analysis_reference_structure, hessian=eigen_amplitude_analysis_hessian)

	#eigen_structure.set_strains_and_amplitudes_from_distorted_structure(relaxed_structure)
	#relaxed_eigen_chromosome =  eigen_structure.get_list_representation()


	#print "b-      a-       c-       a+      b+       c+     FEx      FEy      FEz"
	#print " ".join(str(round(x, 3)) for x in relaxed_eigen_chromosome[:20])
